---
title: 十六、调度算法（2）
tags: ["操作系统"]
categories: OS学习笔记
draft: false
date: 2022-04-25T19:39:43+08:00
---

#### 1.时间片轮转（RR，Round-Robin）

> ##### RR
>
> - 算法思想：公平地、轮流地为每个进程服务，让每个进程在一定时间间隔内都可以得到响应
> - 算法规则：按照各进程到达就绪队列的顺序，轮流让各个进程执行一个**时间片**。若进程未在一个时间片内执行完，则剥夺处理机，将进程重新放回就绪队列尾重新排队。
> - 用于作业/进程调度：用于进程调度（只有作业放入内存建立了相应的进程后，才能被分配处理及时间片）
> - 是否可抢占？：若进程未在一个时间片内执行完，将被剥夺处理机使用权，因此时间片轮转调度算法属于**抢占式**的算法。由时钟装置发出**时钟中断**来通知 CPU 时间片已到。
> - 优缺点：
>
>   - 优点：公平；响应快，适用于分时操作系统
>   - 缺点：由于高频率的进程切换，因此有一定的开销；不区分任务的紧急程度。
>
> - 是否会导致饥饿：不会
> - 补充：时间片太大或太小会有什么影响？

<!--more-->

例题：例题：各进程到达就绪队列的时间、需要的时间如下表所示，使用**时间片轮转**调度算法，分析时间片大小分别是 2、5 时的运行情况。

时间片大小为 2 时的情况：

![LTMgBj.png](https://s1.ax1x.com/2022/04/25/LTMgBj.png)

![LTMTvF.png](https://s1.ax1x.com/2022/04/25/LTMTvF.png)

![LTQibd.png](https://s1.ax1x.com/2022/04/25/LTQibd.png)

时间片大小为 5 时的情况：

![LTQZPP.png](https://s1.ax1x.com/2022/04/25/LTQZPP.png)

注：时间片轮转算法常用于分时操作系统，更注重“响应时间”，因而此处不计算周转时间。对比发现，时间片轮转算法在时间片大小为 5 时和上一篇文章中的“先来先服务算法”调度结果类似。如果**时间片太大**，导致每个进程都能在一个时间片内完成，那么时间片轮转算法就会**退化为先来先服务算法**，并且会**增大进程响应时间**。因此**时间片不能太大**。另外方面，进程切换是有时间代价的（保存，恢复运行环境），因此如果**时间片太小**，会导致**进程切换过于频繁**，系统会花大量的时间来处理进程切换，从而导致实际用于进程执行的时间比例减少。可见**时间片也不能太小**。一般来说，设计时间片时要让切换进程的开销比例不超过 1%。

#### 2.优先级调度算法

> ##### 优先级调度算法
>
> - 算法思想：随着计算机的发展，特别是实时操作系统的出现，越来越多的应用场景需要根据任务的紧急程度来决定处理顺序。
> - 算法规则：每个作业/进程有各自的优先级，调度时选择优先级最高的作业/进程。
> - 用于作业/进程调度：既可用于作业调度，也可用于进程调度。甚至还会用于 I/O 调度中。
> - 是否可抢占？：抢占式、非抢占式都有。非抢占式只需在进程主动放弃处级机时进行调度即可，而非抢占式还需在就绪队列变化时，检查是否会发生抢占。
> - 优缺点：
>
>   - 优点：用优先级区分任务的紧急程度、重要程度，适用于实时操作系统。可灵活的调整对各种作业/进程的偏好程度。
>   - 缺点：若源源不断地有高优先级进程到来，则可能导致饥饿
>
> - 是否会导致饥饿：会

例题：各进程到达就绪队列的时间、需要的时间如下表所示，使用**非抢占式**和**抢占式**的**优先级**调度算法，分析进程的运行情况。（注：**优先数越大优先级越高**）

非抢占式：

![LTQ1Vs.png](https://s1.ax1x.com/2022/04/25/LTQ1Vs.png)

抢占式：

![LTQ3an.png](https://s1.ax1x.com/2022/04/25/LTQ3an.png)

注：就绪队列未必只有一个，可以按照不同的优先级组织。另外，可以吧优先级高的进程排在更靠近对头的位置。根据优先级是否可以动态地改变，可将优先级分为**静态优先级**和**动态优先级**两种。

静态优先级：创建进程时确定，之后一直不变。

动态优先级：创建进程时有一个初始值，之后会根据情况动态地调整优先级。

> 如何和合理设置各类进程的优先级？通常，系统进程优先级**高于**用户进程；前台进程优先级**高于**后台进程；操作系统更**偏好 I/O 进程（或称 I/O 繁忙型进程）**。I/O 设备可以和 CPU 并行工作。如果优先让 I/O 繁忙型进程优先运行的话，则越有可能让 I/O 设备尽早地投入工作，则资源利用率、系统吞吐量都会得到提升。与 I/O 型进程相对的是**计算型进程（或称 CPU 繁忙型进程）**。

> 如果采用的是动态优先级，什么时候应该调整？可以从追求公平，提升资源利用率等角度考虑。如果某进程在就绪队列中等待了很长时间，则可以适当的提升其优先级。如果某进程占用处理机运行了很长时间，则可以适当地降低其优先级。如果发现一个进程频繁的进行 I/O 操作，则可以适当的提升其优先级。

#### 3.思考........

FCFS 算法的优点是公平；

SJF 算法的有点是能尽快处理完短作业，平均等待/周转时间等参数很优秀；

书记安片轮转调度算法可以让各个进程得到及时的响应；

优先级调度算法可以灵活地调整各种进程被服务的机会；能否对其他算法做个折中权衡，得到一个综合表现优秀平衡的算法呢？

缝合怪登场！↓↓↓↓↓↓↓↓↓↓↓↓

#### 4.多级反馈队列调度算法

> ##### 多级反馈队列
>
> - 算法思想：对比其他调度算法的折中权衡。
> - 算法规则：1. 设置多级就绪队列，各级队列优先级从高到低，时间片从小到大；2.新进程到达时先进入第 1 级队列，按 FCFS 原则排队等待被分配时间片，若用完时间片进程还未结束，则进程进入下一级队列队尾，如果此时已经是在最下级的队列，则重新放入该队列队尾；3.只有第 K 级队列为空时，才会为 k+1 级队头的进程分配时间片
> - 用于作业/进程调度：用于进程调度
> - 是否可抢占？：**抢占式**算法。在 k 级队列的进程运行过程中，若更上级的队列（1~k-1 级）中进入了一个新进程，则由于新进程处于优先级更高的队列中，因此新进程会抢占处理机，原来运行的进程放回 k 级队列队尾。
> - 优缺点：
>
>   - 优点：对各类进程相对公平（FCFS 优点）；每个新到达的进程都可以很快就得到响应（RR 优点）；短进程只用较少的时间就可完成（SPF 优点）；不必实现估计进程的运行时间（避免用户作假）；可以灵活地调整对各类进程的偏好程度，比如 CPU 密集型进程、I/O 密集型进程（拓展：可以将因 I/O 而阻塞的进程重新放回原队尾，这样 I/O 型进程就可保持较高优先级）
>
> - 是否会导致饥饿：会

例题：各进程到达就绪队列的时间、需要的时间如下表所示，使用**多级反馈队列**调度算法，分析进程的运行情况。

**视频被投诉下架了,可以自己去 b 站搜一下"王道操作系统"**

#### 5.知识回顾

![LTQYGV.png](https://s1.ax1x.com/2022/04/25/LTQYGV.png)

注：比起早期的批处理操作系统来说，由于计算机造价大幅度降低，因此之后出现的交互式操作系统（包括分时操作系统，实时操作系统等）更注重系统的响应时间、公平性、平衡性等指标。而这几种算法也恰好能较好地满足交互式系统的需求。因此这三种算法更适用于**交互式操作系统**。（比如 UNIX 使用的就是多级反馈队列调度算法）
