---
title: 十七、进程同步和进程互斥
tags: ["操作系统"]
categories: OS学习笔记
draft: false
date: 2022-04-26T20:28:05+08:00
---

#### 1.什么是进程同步

回顾：进程具有**异步性**的特征。异步性是指：各自并发执行的进程以各自独立的、不可预知的速度向前推进。

例子：进程通信 ---- 管道通信

写进程往管道里写数据，读进程再从管道里读数据。读进程和写进程并发地运行，由于并发必然导致异步性，因此“写数据”和“读数据”两个操作执行的先后顺序是不确定的。而实际应用中，又必须按照**“写数据 → 读数据”**的顺序来执行，如何解决这种一部问题，就是**进程同步**所讨论的内容。

<!--more-->

![LHoKCF.png](https://s1.ax1x.com/2022/04/26/LHoKCF.png)

**同步**又称**直接制约关系**，它是指为完成某种任务而建立的两个或多个进程。这些进程因为需要在某些位置上**协调**他们的**工作次序**而产生的制约关系。进程间的直接制约关系就是源于它们之间的相互合作。操作系统需要提供一种**“进程同步机制”**来实现进程的同步执行需求。

#### 2.什么是进程互斥

进程的“并发”需要“共享”的支持。各个并发执行的进程不可避免的需要共享一些系统资源（如内存，打印机和摄像头等 I/O 设备）

> 两种资源的共享方式
>
> - **互斥共享方式**：系统中的某些资源可以提供给多个进程使用，但**一个时间段内只允许一个进程访问资源**。
> - **同时共享方式**：系统中的某些资源，**允许一个时间段内有多个进程“同时”对它们进行访问**。

我们把**一个时间段内只允许一个进程使用**的资源称为**临界资源**，许多物理设备（如打印机，摄像头）都属于临界资源。此外还有许多变量、数据、内存缓冲区等都属于临界资源。

对临界资源的访问，必须**互斥**地进行。互斥，亦称**间接制约关系。进程互斥**指当一个进程访问某临界资源时，另一个想要访问该临界资源的进程必须等待。当访问临界资源的进程结束访问，释放该资源之后，另一个进程才能去访问临界资源。

对临界资源的互斥访问，可以在逻辑上分为如下四个部分：**进入区，临界区，退出区和剩余区**。

```c
do{
    /*
    * 进入区，负责检查是否可进入临界区，若可以进入，则应设置   正在访问临界资源  的标志（可理     * 解为“上锁”），以阻止其他进程同时进入临界区。
    */
    entry section;
    /*
    * 临界区，访问临界资源的那段代码
    */
    circtical section;
    /*
    * 退出区，负责解除 正在访问临界资源 的标志（可理解为“解锁”）
    */
    exit section;
     /*
    * 剩余区，作其他处理
    */
    remainder section;
}while(true)
     /*
    * 注意：临界区是进程中访问临界资源的那段代码。进入区和退出去是负责实现互斥的代码段。临界     * 区亦可成为“临界段”
    */
```

如果一个进程暂时不能进入临界区，那么该进程是否应该一直占着处理机？该进程有没有可能一直进不了临界区？

为了实现对临界资源的互斥访问，同时保证系统整体性能，需要遵循以下原则：

- 空闲让进：临界区空闲时，可以允许一个请求进入临界区的进程立即进入临界区；
- 忙则等待：当已有进程进入临界区时，其他视图进入临界区的进程必须等待。
- 有限等待：对请求访问的进程，应当保证在有限的时间内进入临界区（保证不会饥饿）
- 让权等待：当进程不能进入临界区时，应立即释放处理机，防止进程忙等待（连续等待进入临界区占用大量处理机资源）。

#### 3.知识回顾

![LHbARU.png](https://s1.ax1x.com/2022/04/26/LHbARU.png)
